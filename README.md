# 智能交通信号控制系统 - 两相位优化版本

## 项目简介

这是一个基于强化学习的智能交通信号控制系统，专门针对十字路口进行信号控制优化。系统采用简化的两相位信号控制策略，使用GPU加速的DQN算法实现智能信号控制，最小化车辆延误时间和排队长度。

注意这个项目只是一个菜逼的大作业，很简单，不成熟有很多问题，学生拿来混一混就可以了。可能你能得到一些东西，但是也不太可能。

## 系统特点

- **简化的两相位信号系统**: 南北方向和东西方向交替通行
- **基于强化学习的动态控制**: 使用GPU加速的DQN算法实现智能信号控制
- **实时车辆流量模拟**: 基于泊松分布的车辆到达模拟
- **可视化交通状态**: 实时显示交通状态和性能指标
- **参数化配置**: 模拟器参数和训练参数分别管理
- **GPU加速训练**: 支持NVIDIA GPU加速训练

## 系统架构

### 三大核心模块

1. **交通模拟器模块** (`env/traffic_env.py`)
   - 简化的两相位交通环境模拟
   - 信号灯控制逻辑
   - 车辆排队和通行模拟

2. **可视化模块** (`visualization/visualizer.py`)
   - 路口布局可视化
   - 实时交通状态显示
   - 性能指标图表

3. **强化学习模块** (`agent/gpu_dqn_agent.py`)
   - GPU加速的DQN智能体实现
   - 状态空间和动作空间定义
   - 训练和推理功能

### 辅助模块

- **车辆类** (`traffic/vehicle.py`): 车辆对象定义和属性管理
- **车流生成器** (`traffic/flow_generator.py`): 基于泊松分布的车辆到达模拟
- **工具函数** (`utils/distributions.py`): 概率分布和计算工具

## 路口设计

### 几何布局
- 十字路口，双向共4车道
- 每个方向2车道（左车道和右车道）
- 采用左侧通行规则

### 信号相位
简化的两相位信号系统：

**相位1 - 南北方向通行：**
- 南北方向绿灯（左车道直行、右车道右转同时放行）
- 东西方向红灯

**相位2 - 东西方向通行：**
- 东西方向绿灯（左车道直行、右车道右转同时放行）
- 南北方向红灯

### 车道配置
- **左车道**: 直行专用
- **右车道**: 右转专用

## 车流模拟

### 车辆到达
- 使用泊松分布模拟车辆到达
- 各车道到达率可配置
- 直行车道到达率 > 转弯车道到达率

### 车辆类型
- **小车**: 80%比例
- **大车**: 20%比例

### 通过时间
使用截断正态分布模拟车辆通过路口时间：
- 小车直行: 均值6秒，标准差1秒
- 大车直行: 均值8秒，标准差1.5秒
- 小车右转: 均值3秒，标准差1秒
- 大车右转: 均值4秒，标准差1.5秒

## 优化目标

### 目标函数
最小化加权组合：
```
目标值 = w_delay × 平均延误时间 + w_queue × 排队长度
```

### 权重设置
- 延误时间权重 (w_delay): 0.6
- 排队长度权重 (w_queue): 0.4

## 配置文件

### 模拟器配置 (`simulator_config.json`)
包含所有交通模拟相关的参数：
- 路口几何参数
- 信号相位设置
- 车流参数
- 优化目标权重

### 训练配置 (`training_config.json`)
包含所有强化学习训练相关的参数：
- 网络架构参数
- 训练超参数
- GPU设置
- 模型保存设置

## 安装和运行

### 环境要求
- Python 3.7+
- NVIDIA GPU (推荐) 或 CPU
- 依赖包见 `requirements.txt`

### 安装步骤
```bash
# 克隆项目
git clone [项目地址]

# 安装依赖
pip install -r requirements.txt

# 创建模型保存目录
mkdir models
```

### 运行程序
```bash
python main.py
```

## 使用说明

### 演示模式

1. **基础交通模拟**: 使用固定绿灯时间运行交通模拟
2. **AI智能体训练**: 训练DQN智能体优化信号控制
3. **AI性能演示**: 使用训练好的AI模型进行信号控制
4. **策略性能比较**: 比较不同信号控制策略的性能
5. **交互式演示**: 实时交互式交通模拟

### 功能特点

- **简单易用**: 适合初学者理解和使用
- **参数集中**: 模拟器和训练参数分别管理
- **可视化友好**: 实时显示交通状态和性能指标
- **模块化设计**: 各模块独立，便于扩展和维护
- **GPU加速**: 支持GPU加速训练，提高训练效率

## 技术实现

### 强化学习算法
- **算法**: Deep Q-Network (DQN)
- **状态空间**: 8个车道排队长度 + 相位编码
- **动作空间**: 10个离散的绿灯时间选项
- **奖励函数**: 负的目标函数值

### 神经网络结构
- 输入层: 18个神经元 (8个排队长度 + 10个相位编码)
- 隐藏层: 64个神经元
- 输出层: 10个神经元 (对应10个动作)

### 训练参数
- 学习率: 0.001
- 折扣因子: 0.95
- 探索率: 1.0 → 0.01 (衰减)
- 经验回放: 5000个样本
- 批次大小: 128

### GPU优化
- 支持CUDA加速
- 混合精度训练
- 梯度裁剪
- 批量处理优化

## 性能指标

### 评估指标
- **平均延误时间**: 车辆从到达到通过的总时间
- **排队长度**: 各车道排队车辆数
- **吞吐量**: 单位时间内通过路口的车辆数
- **目标函数值**: 加权组合指标

### 可视化指标
- 实时交通状态显示
- 性能指标趋势图
- 策略比较图表

## 扩展建议

1. **更复杂的神经网络**: 使用卷积神经网络或循环神经网络
2. **多路口协调**: 扩展到多个路口的协调控制
3. **实时数据接入**: 接入真实的交通数据
4. **行人考虑**: 加入行人和非机动车的影响
5. **紧急车辆**: 考虑紧急车辆的优先通行
6. **自适应学习**: 实现在线学习和适应

## 作者

[您的姓名]

## 许可证

[许可证信息] 